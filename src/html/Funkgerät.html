<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mein Funkgerät</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="../../src/css/style.css" media="screen">

</head>
<body>

<h1>Funkgerät Icom Ic M330GE</h1>

<div id="image-wrapper">
  <img class="funkgeraet" src="../../images/IcomIcM330GE.jpg" alt="no">
  <div class="draggable-Knob">
    <img id="rotate-Knob" src="../../images/testKnob.png" alt="no image" width="74" height="74">
  </div>
  <!--    <div class="draggable-Small">-->
  <!--      <img id="rotate-Small" src="../../images/RadSmall.png" alt="no image" width="52" height="52">-->
  <!--    </div>-->
  <div class="buttons-on-bottom">
    <div class="div-Scan">
      <button id="btn-Scan" class="button" onmousedown="mouseDownScan()"
              onmouseup="mouseUpScan()"></button>
    </div>
    <div class="div-DW">
      <button id="btn-DW" class="button" onmousedown="mouseDownDW()"
              onmouseup="mouseUpDW()"></button>
    </div>
    <div class="div-CH_WX">
      <button id="btn-CH_WX" class="button" onmousedown="mouseDownCH_WX()"
              onmouseup="mouseUpCH_WX()"></button>
    </div>
    <div class="div-HI_LO">
      <button id="btn-HI_LO" class="button" onmousedown="mouseDownHI_LO()"
              onmouseup="mouseUpHI_LO()"></button>
    </div>
  </div>
  <div class="temp">
    <button id="btn-Temp" class="button blue-button" onmousedown="mouseDownTemp()"
            onmouseup="mouseUpTemp()"></button>
  </div>
  <div class="side-buttons">
    <div class="top-row">
      <div class="div-button-up">
        <button id="btn-up" class="button" onmousedown="mouseDownBtnUp()"
                onmouseup="mouseUpBtnUp()"></button>
      </div>
    </div>
    <div class="middle-row">
      <div class="div-button-left">
        <button id="btn-left" class="button" onmousedown="mouseDownBtnLeft()"
                onmouseup="mouseUpBtnLeft()"></button>
      </div>
      <div class="div-enter">
        <button id="btn-enter" class="button" onmousedown="mouseDownBtnEnter()"
                onmouseup="mouseUpBtnEnter()"></button>
      </div>
      <div class="div-button-right">
        <button id="btn-right" class="button" onmousedown="mouseDownBtnRight()"
                onmouseup="mouseUpBtnRight()"></button>
      </div>
    </div>
    <div class="bottom-row">
      <div class="div-button-menu">
        <button id="btn-menu" class="button" onmousedown="mouseDownBtnMenu()"
                onmouseup="mouseUpBtnMenu()"></button>
      </div>
      <div class="div-down">
        <button id="btn-down" class="button" onmousedown="mouseDownBtnDown()"
                onmouseup="mouseUpBtnDown()"></button>
      </div>
      <div class="div-button-clear">
        <button id="btn-clear" class="button" onmousedown="mouseDownBtnClear()"
                onmouseup="mouseUpBtnClear()"></button>
      </div>
    </div>
  </div>
</div>


<script type="text/javascript">

  const elementIds = [
    'btn-Scan',
    'btn-DW',
    'btn-CH_WX',
    'btn-HI_LO',
    'btn-Temp',
    'btn-up',
    'btn-left',
    'btn-enter',
    'btn-right',
    'btn-menu',
    'btn-down',
    'btn-clear'
  ];

  const elements = elementIds.map(id => document.getElementById(id));

  function getWidthAndHeight(elemId) {
    const i = elementIds.findIndex(id => id === elemId);
    return {width: elements[i].style.width, height: elements[i].style.height}
  }

  const {width: clientWidthScan, height: clientHeightScan} = getWidthAndHeight('btn-Scan');
  const {width: clientWidthDW, height: clientHeightDW} = getWidthAndHeight('btn-DW');
  const {width: clientWidthCH_WX, height: clientHeightCH_WX} = getWidthAndHeight('btn-CH_WX');
  const {width: clientWidthHI_LO, height: clientHeightHI_LO} = getWidthAndHeight('btn-HI_LO');
  const {width: clientWidthTemp, height: clientHeightTemp} = getWidthAndHeight('btn-Temp');
  const {width: clientWidthBtnUp, height: clientHeightBtnUp} = getWidthAndHeight('btn-up');
  const {width: clientWidthBtnLeft, height: clientHeightBtnLeft} = getWidthAndHeight('btn-left');
  const {width: clientWidthBtnEnter, height: clientHeightBtnEnter} = getWidthAndHeight('btn-enter');
  const {width: clientWidthBtnRight, height: clientHeightBtnRight} = getWidthAndHeight('btn-right');
  const {width: clientWidthBtnMenu, height: clientHeightBtnMenu} = getWidthAndHeight('btn-menu');
  const {width: clientWidthBtnDown, height: clientHeightBtnDown} = getWidthAndHeight('btn-down');
  const {width: clientWidthBtnClear, height: clientHeightBtnClear} = getWidthAndHeight('btn-clear');


  function mouseDownScan() {
    const i = elementIds.findIndex(id => id === 'btn-Scan');
    elements[i].style.width = '48px';
    elements[i].style.height = '29px';
  }

  function mouseUpScan() {
    const i = elementIds.findIndex(id => id === 'btn-Scan');
    elements[i].style.width = clientWidthScan;
    elements[i].style.height = clientHeightScan;
    document.getElementsByTagName('BODY')[0].style.backgroundColor = '#ffffff';
  }

  function mouseDownDW() {
    const i = elementIds.findIndex(id => id === 'btn-DW');
    elements[i].style.width = '48px';
    elements[i].style.height = '28px';
  }

  function mouseUpDW() {
    const i = elementIds.findIndex(id => id === 'btn-DW');
    elements[i].style.width = clientWidthDW;
    elements[i].style.height = clientHeightDW;
    document.getElementsByTagName('BODY')[0].style.backgroundColor = 'red';
  }

  function mouseDownCH_WX() {
    const i = elementIds.findIndex(id => id === 'btn-CH_WX');
    elements[i].style.width = '48px';
    elements[i].style.height = '28px';
  }

  function mouseUpCH_WX() {
    const i = elementIds.findIndex(id => id === 'btn-CH_WX');
    elements[i].style.width = clientWidthCH_WX;
    elements[i].style.height = clientHeightCH_WX;
    document.getElementsByTagName('BODY')[0].style.backgroundColor = 'green';
  }

  function mouseDownHI_LO() {
    const i = elementIds.findIndex(id => id === 'btn-HI_LO');
    elements[i].style.width = '48px';
    elements[i].style.height = '28px';
  }

  function mouseUpHI_LO() {
    const i = elementIds.findIndex(id => id === 'btn-HI_LO');
    elements[i].style.width = clientWidthHI_LO;
    elements[i].style.height = clientHeightHI_LO;
    document.getElementsByTagName('BODY')[0].style.backgroundColor = 'blue';
  }

  function mouseDownTemp() {
    const i = elementIds.findIndex(id => id === 'btn-Temp');
    elements[i].style.width = '31px';
    elements[i].style.height = '31px';
  }

  function mouseUpTemp() {
    const i = elementIds.findIndex(id => id === 'btn-Temp');
    elements[i].style.width = clientWidthTemp;
    elements[i].style.height = clientHeightTemp;
    document.getElementsByTagName('BODY')[0].style.backgroundColor = 'turquoise';
  }

  function mouseDownBtnLeft() {
    const i = elementIds.findIndex(id => id === 'btn-left');
    elements[i].style.width = '27px';
    elements[i].style.height = '34px';
  }

  function mouseUpBtnLeft() {
    const i = elementIds.findIndex(id => id === 'btn-left');
    elements[i].style.width = clientWidthBtnLeft;
    elements[i].style.height = clientHeightBtnLeft;
  }

  function mouseDownBtnUp() {
    const i = elementIds.findIndex(id => id === 'btn-up');
    elements[i].style.width = '40px';
    elements[i].style.height = '24px';
  }

  function mouseUpBtnUp() {
    const i = elementIds.findIndex(id => id === 'btn-up');
    elements[i].style.width = clientWidthBtnUp;
    elements[i].style.height = clientHeightBtnUp;
  }

  function mouseDownBtnEnter() {
    const i = elementIds.findIndex(id => id === 'btn-enter');
    elements[i].style.width = '36px';
    elements[i].style.height = '29px';
  }

  function mouseUpBtnEnter() {
    const i = elementIds.findIndex(id => id === 'btn-enter');
    elements[i].style.width = clientWidthBtnEnter;
    elements[i].style.height = clientHeightBtnEnter;
  }

  function mouseDownBtnRight() {
    const i = elementIds.findIndex(id => id === 'btn-right');
    elements[i].style.width = '28px';
    elements[i].style.height = '34px';
  }

  function mouseUpBtnRight() {
    const i = elementIds.findIndex(id => id === 'btn-right');
    elements[i].style.width = clientWidthBtnRight;
    elements[i].style.height = clientHeightBtnRight;
  }

  function mouseDownBtnMenu() {
    const i = elementIds.findIndex(id => id === 'btn-menu');
    elements[i].style.width = '30px';
    elements[i].style.height = '23px';
  }

  function mouseUpBtnMenu() {
    const i = elementIds.findIndex(id => id === 'btn-menu');
    elements[i].style.width = clientWidthBtnMenu;
    elements[i].style.height = clientHeightBtnMenu;
  }

  function mouseDownBtnDown() {
    const i = elementIds.findIndex(id => id === 'btn-down');
    elements[i].style.width = '39px';
    elements[i].style.height = '24px';
  }

  function mouseUpBtnDown() {
    const i = elementIds.findIndex(id => id === 'btn-down');
    elements[i].style.width = clientWidthBtnDown;
    elements[i].style.height = clientHeightBtnDown;
  }

  function mouseDownBtnClear() {
    const i = elementIds.findIndex(id => id === 'btn-clear');
    elements[i].style.width = '32px';
    elements[i].style.height = '24px';
  }

  function mouseUpBtnClear() {
    const i = elementIds.findIndex(id => id === 'btn-clear');
    elements[i].style.width = clientWidthBtnClear;
    elements[i].style.height = clientHeightBtnClear;
  }

  function installRotateOf(elementId, callback) {
    const R2D = 180 / Math.PI;
    const rotateElement = document.getElementById(elementId);

    let active = false,
        angle = 0,
        rotation = 0,
        startAngle = 0,
        center = {
          x: 0,
          y: 0
        };

    // value being sent outside by callback
    let currentRotation = 0;

    const stop = () => {
      angle += rotation;

      // "reset" angle if greater than one rotation
      while (angle > 360) {
        angle -= 360;
      }

      currentRotation = angle;

      // range from angle 270 to 360 is being displayed from -1 (359) to -89 (271). We need to
      // normalize it in order to process it easier later on.
      if (currentRotation < 0) {
        currentRotation = 270 + (currentRotation + 90)
      }

      // reset rotation if it gets buggy by dragging like stupid.
      if (currentRotation < 0) {
        currentRotation = 0;
      }

      angle = currentRotation;

      active = false;
    };

    function rotate(e) {
      e.preventDefault();
      let x = e.clientX - center.x,
          y = e.clientY - center.y,
          d = R2D * Math.atan2(y, x);
      rotation = d - startAngle;

      return rotateElement.style.webkitTransform = 'rotate(' + (angle + rotation)
          + 'deg)';
    }

    function start(e) {
      e.preventDefault();
      let bb = this.getBoundingClientRect(),
          t = bb.top,
          l = bb.left,
          h = bb.height,
          w = bb.width,
          x, y;
      center = {
        x: l + (w / 2),
        y: t + (h / 2)
      };
      x = e.clientX - center.x;
      y = e.clientY - center.y;
      startAngle = R2D * Math.atan2(y, x);
      active = true;
    }

    function init() {
      rotateElement.addEventListener('mousedown', start, false);
      $(document).bind('mousemove', function (event) {
        if (active === true) {
          event.preventDefault();
          // event.stopImmediatePropagation();
          rotate(event);
        }
      });
      $(document).bind('mouseup', function (event) {
        event.preventDefault();
        // event.stopImmediatePropagation();
        if (active === true) {
          stop(event);
          callback(angle)
        }
      });
    }

    init();
  }

  installRotateOf('rotate-Knob', function (cr) {
    console.log('rotate-Knob:', cr)
  });
  installRotateOf('rotate-Knob', function (cr) {
    console.log('rotate-Knob:', cr)
  });

</script>

</body>
</html>
