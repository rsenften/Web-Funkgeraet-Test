<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mein Funkgerät</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="../../src/css/style.css" media="screen">

</head>
<body>

<h1>Funkgerät Icom Ic M330GE</h1>

<div id="image-wrapper">
  <img class="funkgeraet" src="../../images/IcomIcM330GE.jpg" alt="no">
  <div class="draggable-Knob">
    <img id="rotate-Knob" src="../../images/testKnob.png" alt="no image" width="74" height="74">
  </div>
  <!--    <div class="draggable-Small">-->
  <!--      <img id="rotate-Small" src="../../images/RadSmall.png" alt="no image" width="52" height="52">-->
  <!--    </div>-->
  <div class="buttons-on-bottom">
    <div class="div-Scan">
      <button id="btn-Scan" class="button" onmousedown="mouseDownScan()"
              onmouseup="mouseUpScan()"></button>
    </div>
    <div class="div-DW">
      <button id="btn-DW" class="button" onmousedown="mouseDownDW()"
              onmouseup="mouseUpDW()"></button>
    </div>
    <div class="div-CH_WX">
      <button id="btn-CH_WX" class="button" onmousedown="mouseDownCH_WX()"
              onmouseup="mouseUpCH_WX()"></button>
    </div>
    <div class="div-HI_LO">
      <button id="btn-HI_LO" class="button" onmousedown="mouseDownHI_LO()"
              onmouseup="mouseUpHI_LO()"></button>
    </div>
  </div>
  <div class="temp">
    <button id="btn-Temp" class="button blue-button" onmousedown="mouseDownTemp()"
            onmouseup="mouseUpTemp()"></button>
  </div>
  <div class="side-buttons">
    <div class="top-row">
      <div class="div-button-up">
        <button id="btn-up" class="button" onmousedown="mouseDownBtnUp()"
                onmouseup="mouseUpBtnUp()"></button>
      </div>
    </div>
    <div class="middle-row">
      <div class="div-button-left">
        <button id="btn-left" class="button" onmousedown="mouseDownBtnLeft()"
                onmouseup="mouseUpBtnLeft()"></button>
      </div>
      <div class="div-enter">
        <button id="btn-enter" class="button" onmousedown="mouseDownBtnEnter()"
                onmouseup="mouseUpBtnEnter()"></button>
      </div>
      <div class="div-button-right">
        <button id="btn-right" class="button" onmousedown="mouseDownBtnRight()"
                onmouseup="mouseUpBtnRight()"></button>
      </div>
    </div>
    <div class="bottom-row">
      <div class="div-button-menu">
        <button id="btn-menu" class="button" onmousedown="mouseDownBtnMenu()"
                onmouseup="mouseUpBtnMenu()"></button>
      </div>
      <div class="div-down">
        <button id="btn-down" class="button" onmousedown="mouseDownBtnDown()"
                onmouseup="mouseUpBtnDown()"></button>
      </div>
      <div class="div-button-clear">
        <button id="btn-clear" class="button" onmousedown="mouseDownBtnClear()"
                onmouseup="mouseUpBtnClear()"></button>
      </div>
    </div>
  </div>
</div>


<script type="text/javascript">

  var clientWidthScan = document.getElementById('btn-Scan').style.width;
  var clientHeightScan = document.getElementById('btn-Scan').style.height;
  var clientWidthDW = document.getElementById('btn-DW').style.width;
  var clientHeightDW = document.getElementById('btn-DW').style.height;
  var clientWidthCH_WX = document.getElementById('btn-CH_WX').style.width;
  var clientHeightCH_WX = document.getElementById('btn-CH_WX').style.height;
  var clientWidthHI_LO = document.getElementById('btn-HI_LO').style.width;
  var clientHeightHI_LO = document.getElementById('btn-HI_LO').style.height;
  var clientWidthTemp = document.getElementById('btn-Temp').style.width;
  var clientHeightTemp = document.getElementById('btn-Temp').style.height;
  var clientWidthBtnUp = document.getElementById('btn-up').style.width;
  var clientHeightBtnUp = document.getElementById('btn-up').style.height;
  var clientWidthBtnLeft = document.getElementById('btn-left').style.width;
  var clientHeightBtnLeft = document.getElementById('btn-left').style.height;
  var clientWidthBtnEnter = document.getElementById('btn-enter').style.width;
  var clientHeightBtnEnter = document.getElementById('btn-enter').style.height;
  var clientWidthBtnRight = document.getElementById('btn-right').style.width;
  var clientHeightBtnRight = document.getElementById('btn-right').style.height;
  var clientWidthBtnMenu = document.getElementById('btn-menu').style.width;
  var clientHeightBtnMenu = document.getElementById('btn-menu').style.height;
  var clientWidthBtnDown = document.getElementById('btn-down').style.width;
  var clientHeightBtnDown = document.getElementById('btn-down').style.height;
  var clientWidthBtnClear = document.getElementById('btn-clear').style.width;
  var clientHeightBtnClear = document.getElementById('btn-clear').style.height;

  function mouseDownScan() {
    document.getElementById('btn-Scan').style.width = '48px';
    document.getElementById('btn-Scan').style.height = '29px';
  }

  function mouseUpScan() {
    document.getElementById('btn-Scan').style.width = clientWidthScan.toString();
    document.getElementById('btn-Scan').style.height = clientHeightScan.toString();
    document.getElementsByTagName('BODY')[0].style.backgroundColor = '#ffffff';
  }

  function mouseDownDW() {
    document.getElementById('btn-DW').style.width = '48px';
    document.getElementById('btn-DW').style.height = '28px';
  }

  function mouseUpDW() {
    document.getElementById('btn-DW').style.width = clientWidthDW.toString();
    document.getElementById('btn-DW').style.height = clientHeightDW.toString();
    document.getElementsByTagName('BODY')[0].style.backgroundColor = 'red';
  }

  function mouseDownCH_WX() {
    document.getElementById('btn-CH_WX').style.width = '48px';
    document.getElementById('btn-CH_WX').style.height = '28px';
  }

  function mouseUpCH_WX() {
    document.getElementById('btn-CH_WX').style.width = clientWidthCH_WX.toString();
    document.getElementById('btn-CH_WX').style.height = clientHeightCH_WX.toString();
    document.getElementsByTagName('BODY')[0].style.backgroundColor = 'green';
  }

  function mouseDownHI_LO() {
    document.getElementById('btn-HI_LO').style.width = '48px';
    document.getElementById('btn-HI_LO').style.height = '28px';
  }

  function mouseUpHI_LO() {
    document.getElementById('btn-HI_LO').style.width = clientWidthHI_LO.toString();
    document.getElementById('btn-HI_LO').style.height = clientHeightHI_LO.toString();
    document.getElementsByTagName('BODY')[0].style.backgroundColor = 'blue';
  }

  function mouseDownTemp() {
    document.getElementById('btn-Temp').style.width = '31px';
    document.getElementById('btn-Temp').style.height = '31px';
  }

  function mouseUpTemp() {
    document.getElementById('btn-Temp').style.width = clientWidthTemp.toString();
    document.getElementById('btn-Temp').style.height = clientHeightTemp.toString();
    document.getElementsByTagName('BODY')[0].style.backgroundColor = 'turquoise';
  }

  function mouseDownBtnLeft() {
    document.getElementById('btn-left').style.width = '27px';
    document.getElementById('btn-left').style.height = '34px';
  }

  function mouseUpBtnLeft() {
    document.getElementById('btn-left').style.width = clientWidthBtnLeft.toString();
    document.getElementById('btn-left').style.height = clientHeightBtnLeft.toString();
  }

  function mouseDownBtnUp() {
    document.getElementById('btn-up').style.width = '40px';
    document.getElementById('btn-up').style.height = '24px';
  }

  function mouseUpBtnUp() {
    document.getElementById('btn-up').style.width = clientWidthBtnUp.toString();
    document.getElementById('btn-up').style.height = clientHeightBtnUp.toString();
  }

  function mouseDownBtnEnter() {
    document.getElementById('btn-enter').style.width = '36px';
    document.getElementById('btn-enter').style.height = '29px';
  }

  function mouseUpBtnEnter() {
    document.getElementById('btn-enter').style.width = clientWidthBtnEnter.toString();
    document.getElementById('btn-enter').style.height = clientHeightBtnEnter.toString();
  }

  function mouseDownBtnRight() {
    document.getElementById('btn-right').style.width = '28px';
    document.getElementById('btn-right').style.height = '34px';
  }

  function mouseUpBtnRight() {
    document.getElementById('btn-right').style.width = clientWidthBtnRight.toString();
    document.getElementById('btn-right').style.height = clientHeightBtnRight.toString();
  }

  function mouseDownBtnMenu() {
    document.getElementById('btn-menu').style.width = '30px';
    document.getElementById('btn-menu').style.height = '23px';
  }

  function mouseUpBtnMenu() {
    document.getElementById('btn-menu').style.width = clientWidthBtnMenu.toString();
    document.getElementById('btn-menu').style.height = clientHeightBtnMenu.toString();
  }

  function mouseDownBtnDown() {
    document.getElementById('btn-down').style.width = '39px';
    document.getElementById('btn-down').style.height = '24px';
  }

  function mouseUpBtnDown() {
    document.getElementById('btn-down').style.width = clientWidthBtnDown.toString();
    document.getElementById('btn-down').style.height = clientHeightBtnDown.toString();
  }

  function mouseDownBtnClear() {
    document.getElementById('btn-clear').style.width = '31px';
    document.getElementById('btn-clear').style.height = '24px';
  }

  function mouseUpBtnClear() {
    document.getElementById('btn-clear').style.width = clientWidthBtnClear.toString();
    document.getElementById('btn-clear').style.height = clientHeightBtnClear.toString();
  }

  function installRotateOf(elementId, callback) {
    const R2D = 180 / Math.PI;
    const rotateElement = document.getElementById(elementId);

    let active = false,
        angle = 0,
        rotation = 0,
        startAngle = 0,
        center = {
          x: 0,
          y: 0
        };

    // value being sent outside by callback
    let currentRotation = 0;

    const stop = () => {
      angle += rotation;

      // "reset" angle if greater than one rotation
      while (angle > 360) {
        angle -= 360;
      }

      currentRotation = angle;

      // range from angle 270 to 360 is being displayed from -1 (359) to -89 (271). We need to
      // normalize it in order to process it easier later on.
      if (currentRotation < 0) {
        currentRotation = 270 + (currentRotation + 90)
      }

      // reset rotation if it gets buggy by dragging like stupid.
      if (currentRotation < 0) {
        currentRotation = 0;
      }

      angle = currentRotation;

      active = false;
    };

    function rotate(e) {
      e.preventDefault();
      var x = e.clientX - center.x,
          y = e.clientY - center.y,
          d = R2D * Math.atan2(y, x);
      rotation = d - startAngle;

      return rotateElement.style.webkitTransform = 'rotate(' + (angle + rotation)
          + 'deg)';
    }

    function start(e) {
      e.preventDefault();
      var bb = this.getBoundingClientRect(),
          t = bb.top,
          l = bb.left,
          h = bb.height,
          w = bb.width,
          x, y;
      center = {
        x: l + (w / 2),
        y: t + (h / 2)
      };
      x = e.clientX - center.x;
      y = e.clientY - center.y;
      startAngle = R2D * Math.atan2(y, x);
      active = true;
    }

    function init() {
      rotateElement.addEventListener('mousedown', start, false);
      $(document).bind('mousemove', function (event) {
        if (active === true) {
          event.preventDefault();
          // event.stopImmediatePropagation();
          rotate(event);
        }
      });
      $(document).bind('mouseup', function (event) {
        event.preventDefault();
        // event.stopImmediatePropagation();
        if (active === true) {
          stop(event);
          callback(angle)
        }
      });
    }

    init();
  }

  installRotateOf('rotate-Knob', function (cr) {
    console.log('rotate-Knob:', cr)
  });
  installRotateOf('rotate-Knob', function (cr) {
    console.log('rotate-Knob:', cr)
  });

</script>

</body>
</html>
